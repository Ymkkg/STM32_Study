#include "timer_driver.h"

void Start_Timer(TIMx_Reg_t *pTIMx)
{
	pTIMx->CR1 |= 1 << CEN;
}

void Set_Timer_Prescaler(TIMx_Reg_t *pTIMx, uint16_t prescaler)
{
	pTIMx->PSC = prescaler;
}

void Set_Timer_Auto_Reload(TIMx_Reg_t *pTIMx, uint16_t reload_value)
{
	pTIMx->ARR = reload_value;
}

void delay_ms(uint16_t time)
{
	TIMx_Reg_t *pTIM6 = (TIMx_Reg_t*)TIM6_ADDR;
	pTIM6->CNT = 0;

	for(int i=0;i<time*10000;i++)
	{
		pTIM6->SR &= ~(1 << 0);
		while((pTIM6->SR & 0x01) == 0);
	}
}

void Set_Timer_DMA_Interrupt(TIMx_Reg_t *pTIMx, uint8_t mode)
{
	pTIMx->DIER |= 1 << 0;
}
